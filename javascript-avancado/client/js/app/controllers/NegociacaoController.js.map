{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","Negociacao","NegociacaoService","DateHelper","Bind","MensagemView","NegociacoesView","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_negociacaoService","_listaNegociacao","_mensagem","_init","event","preventDefault","negociacao","_criaNegociacao","cadastrar","then","adiciona","_limpaFormulario","texto","mensagem","catch","error","limpaTodos","limpa","importa","negociacoes","forEach","length","negociacaoDate","textoParaData","value","parseInt","parseFloat","focus","listaNegociacoesOffline","adicionaLote","setInterval","importaNegociacoes"],"mappings":";;;;;;;;;;;;;;;AAASA,4B,6BAAAA,gB;;AACAC,oB,qBAAAA,Q;;AACAC,sB,uBAAAA,U;;AACAC,6B,gCAAAA,iB;;AACAC,sB,wBAAAA,U;;AACAC,gB,kBAAAA,I;;AACAC,wB,wBAAAA,Y;;AACAC,2B,2BAAAA,e;;;;;;;;;;;;;;;;;;;;;4CAEIC,oB;AAET,gDAAc;AAAA;;AACV,wBAAIC,IAAIC,SAASC,aAAT,CAAuBC,IAAvB,CAA4BF,QAA5B,CAAR;AACA,yBAAKG,UAAL,GAAkBJ,EAAE,OAAF,CAAlB;AACA,yBAAKK,gBAAL,GAAwBL,EAAE,aAAF,CAAxB;AACA,yBAAKM,WAAL,GAAmBN,EAAE,QAAF,CAAnB;AACA,yBAAKO,kBAAL,GAA0B,IAAIb,iBAAJ,EAA1B;;AAEA,yBAAKc,gBAAL,GAAwB,IAAIZ,IAAJ,CACpB,IAAIL,gBAAJ,EADoB,EAEpB,IAAIO,eAAJ,CAAoBE,EAAE,kBAAF,CAApB,CAFoB,EAGpB,UAHoB,EAIpB,cAJoB,EAKpB,OALoB,CAAxB;;AAOA,yBAAKS,SAAL,GAAiB,IAAIb,IAAJ,CACb,IAAIJ,QAAJ,EADa,EAEb,IAAIK,YAAJ,CAAiBG,EAAE,gBAAF,CAAjB,CAFa,EAGb,OAHa,CAAjB;;AAKA,yBAAKU,KAAL;AACH;;;;6CAEQC,K,EAAO;AAAA;;AACZA,8BAAMC,cAAN;;AAEA,4BAAIC,aAAa,KAAKC,eAAL,EAAjB;;AAEA,6BAAKP,kBAAL,CACKQ,SADL,CACeF,UADf,EAEKG,IAFL,CAEU,oBAAY;AACd,kCAAKR,gBAAL,CAAsBS,QAAtB,CAA+BJ,UAA/B;AACA,kCAAKK,gBAAL;AACA,kCAAKT,SAAL,CAAeU,KAAf,GAAuBC,QAAvB;AACH,yBANL,EAOKC,KAPL,CAOW;AAAA,mCAAS,MAAKZ,SAAL,CAAeU,KAAf,GAAuBG,KAAhC;AAAA,yBAPX;AAQH;;;0CAEKX,K,EAAO;AAAA;;AACTA,8BAAMC,cAAN;;AAEA,6BAAKL,kBAAL,CACKgB,UADL,GAEKP,IAFL,CAEU,oBAAY;AACd,mCAAKR,gBAAL,CAAsBgB,KAAtB;AACA,mCAAKf,SAAL,CAAeU,KAAf,GAAuBC,QAAvB;AACH,yBALL,EAMKC,KANL,CAMW;AAAA,mCAAS,OAAKZ,SAAL,CAAeU,KAAf,GAAuBG,KAAhC;AAAA,yBANX;AAOH;;;yDAEoB;AAAA;;AACjB,6BAAKf,kBAAL,CACKkB,OADL,CACa,KAAKjB,gBAAL,CAAsBkB,WADnC,EAEKV,IAFL,CAEU,uBAAc;AAChBU,wCAAYC,OAAZ,CAAoB;AAAA,uCAAc,OAAKnB,gBAAL,CAAsBS,QAAtB,CAA+BJ,UAA/B,CAAd;AAAA,6BAApB;AACA,gCAAGa,YAAYE,MAAZ,GAAqB,CAAxB,EAA0B;AACtB,uCAAKnB,SAAL,CAAeU,KAAf,GAAuB,iCAAvB;AACH;AACJ,yBAPL,EAQKE,KARL,CAQW;AAAA,mCAAS,OAAKZ,SAAL,CAAeU,KAAf,GAAuBG,KAAhC;AAAA,yBARX;AASH;;;sDAEiB;AACd,4BAAIO,iBAAiBlC,WAAWmC,aAAX,CAAyB,KAAK1B,UAAL,CAAgB2B,KAAzC,CAArB;;AAEA,+BAAO,IAAItC,UAAJ,CACHoC,cADG,EAEHG,SAAS,KAAK3B,gBAAL,CAAsB0B,KAA/B,CAFG,EAGHE,WAAW,KAAK3B,WAAL,CAAiByB,KAA5B,CAHG,CAAP;AAKH;;;uDAEkB;AACf,6BAAK3B,UAAL,CAAgB2B,KAAhB,GAAwB,EAAxB;AACA,6BAAK1B,gBAAL,CAAsB0B,KAAtB,GAA8B,CAA9B;AACA,6BAAKzB,WAAL,CAAiByB,KAAjB,GAAyB,GAAzB;;AAEA,6BAAK3B,UAAL,CAAgB8B,KAAhB;AACH;;;4CAEM;AAAA;;AACH,6BAAK3B,kBAAL,CACK4B,uBADL,GAEKnB,IAFL,CAEU;AAAA,mCAAe,OAAKR,gBAAL,CAAsB4B,YAAtB,CAAmCV,WAAnC,CAAf;AAAA,yBAFV,EAGKL,KAHL,CAGW;AAAA,mCAAS,OAAKZ,SAAL,CAAeU,KAAf,GAAuBG,KAAhC;AAAA,yBAHX;;AAKAe,oCAAY,YAAM;AACd,mCAAKC,kBAAL;AACH,yBAFD,EAEG,IAFH;AAGH","file":"NegociacaoController.js","sourcesContent":["import { ListaNegociacoes } from '../models/ListaNegociacoes.js'\r\nimport { Mensagem } from '../models/Mensagem.js'\r\nimport { Negociacao } from '../models/Negociacao.js'\r\nimport { NegociacaoService } from '../services/NegociacaoService.js'\r\nimport { DateHelper } from '../helpers/DateHelper.js'\r\nimport { Bind } from '../helpers/Bind.js'\r\nimport { MensagemView } from '../views/MensagemView.js'\r\nimport { NegociacoesView } from '../views/NegociacoesView.js'\r\n\r\nexport class NegociacaoController {\r\n\r\n    constructor() {\r\n        let $ = document.querySelector.bind(document);\r\n        this._inputData = $(\"#data\");\r\n        this._inputQuantidade = $(\"#quantidade\");\r\n        this._inputValor = $(\"#valor\");\r\n        this._negociacaoService = new NegociacaoService();\r\n\r\n        this._listaNegociacao = new Bind(\r\n            new ListaNegociacoes(),\r\n            new NegociacoesView($(\"#negociacao-view\")),\r\n            \"adiciona\",\r\n            \"adicionaLote\",\r\n            \"limpa\");\r\n\r\n        this._mensagem = new Bind(\r\n            new Mensagem(),\r\n            new MensagemView($(\"#mensagem-view\")),\r\n            \"texto\");\r\n\r\n        this._init();\r\n    }\r\n\r\n    adiciona(event) {\r\n        event.preventDefault();\r\n        \r\n        let negociacao = this._criaNegociacao();\r\n\r\n        this._negociacaoService\r\n            .cadastrar(negociacao)\r\n            .then(mensagem => {\r\n                this._listaNegociacao.adiciona(negociacao);                \r\n                this._limpaFormulario();\r\n                this._mensagem.texto = mensagem;\r\n            })\r\n            .catch(error => this._mensagem.texto = error);\r\n    }\r\n\r\n    limpa(event) {\r\n        event.preventDefault();\r\n\r\n        this._negociacaoService\r\n            .limpaTodos()\r\n            .then(mensagem => {\r\n                this._listaNegociacao.limpa();\r\n                this._mensagem.texto = mensagem;\r\n            })\r\n            .catch(error => this._mensagem.texto = error);\r\n    }\r\n\r\n    importaNegociacoes() {\r\n        this._negociacaoService\r\n            .importa(this._listaNegociacao.negociacoes)\r\n            .then(negociacoes =>{\r\n                negociacoes.forEach(negociacao => this._listaNegociacao.adiciona(negociacao));\r\n                if(negociacoes.length > 0){\r\n                    this._mensagem.texto = \"Negociacoes obtidas com sucesso\";\r\n                }\r\n            })\r\n            .catch(error => this._mensagem.texto = error);\r\n    }\r\n\r\n    _criaNegociacao() {\r\n        let negociacaoDate = DateHelper.textoParaData(this._inputData.value);\r\n\r\n        return new Negociacao(\r\n            negociacaoDate,\r\n            parseInt(this._inputQuantidade.value),\r\n            parseFloat(this._inputValor.value)\r\n        );\r\n    }\r\n\r\n    _limpaFormulario() {\r\n        this._inputData.value = \"\";\r\n        this._inputQuantidade.value = 1;\r\n        this._inputValor.value = 0.0;\r\n\r\n        this._inputData.focus();\r\n    }\r\n\r\n    _init(){\r\n        this._negociacaoService\r\n            .listaNegociacoesOffline()\r\n            .then(negociacoes => this._listaNegociacao.adicionaLote(negociacoes))\r\n            .catch(error => this._mensagem.texto = error);\r\n        \r\n        setInterval(() => {\r\n            this.importaNegociacoes();\r\n        }, 3000)\r\n    }\r\n}"]}